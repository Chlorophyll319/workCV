# Claude 對話紀錄 - 2025-09-10 14:23:00

## 問題描述
用戶反映「tab 的長度會影響 main 的大小」，經過討論發現問題是：當 Tab 數量增多時，Tab 容器的總寬度會變長，而因為 Tab 容器和 main 都在同一個 flex 容器內，所以 main 的寬度也會跟著一起變長。

## 解決方案
用戶提出將 Tab 系統改為單一 Tab 模式，具體需求：
1. 只顯示一個 Tab 標籤
2. 根據按哪個檔案按鈕顯示對應的標籤
3. 將關閉 icon 改成鎖頭 icon，不讓使用者關閉頁籤

## 實作步驟

### 1. 移除多個 Tab 的循環顯示邏輯 ✅
- 將原本的 `v-for="(tab, index) in openTabs"` 循環移除
- 改為單一 Tab div

### 2. 改為單一 Tab 顯示當前活躍檔案 ✅
```vue
<!-- 修改前：多 Tab 循環 -->
<div v-for="(tab, index) in openTabs" :key="tab.id">
  <!-- Tab 內容 -->
</div>

<!-- 修改後：單一 Tab -->
<div :class="['relative w-[200px] h-[35px] ...]">
  <Icon :icon="activeFile.icon" />
  <span>{{ activeFile.displayName }}</span>
  <Icon icon="heroicons:lock-closed" />
</div>
```

### 3. 將關閉 icon 改為鎖頭 icon ✅
- 原本：`icon="heroicons:x-mark"` 
- 修改為：`icon="heroicons:lock-closed"`
- 新增 `title="此分頁已鎖定"` 提示

### 4. 移除 Tab 關閉功能 ✅
- 移除 `@click.stop="closeTab(tab)"` 事件
- 移除 `openTabs` 響應式變數
- 移除 `closeTab()` 函數
- 移除 `setActiveTab()` 函數
- 簡化 `handleFileClick()` 函數，只保留切換活躍檔案和導航功能

## 程式碼變更

### Template 變更
```vue
<!-- Tab 列容器 -->
<div class="h-[35px] bg-primary-100 border-b border-primary-200 flex items-stretch">
  <!-- 單一 Tab -->
  <div :class="['relative w-[200px] h-[35px] border-r border-primary-200 flex items-center gap-2 px-3 bg-card', activeFile.type === '延伸模組' ? 'font-medium' : '']">
    <Icon :icon="activeFile.icon" class="w-3 h-3" :style="{ color: getFileColor(activeFile.id) }" />
    <span class="text-sm truncate">{{ activeFile.displayName }}</span>
    <Icon icon="heroicons:lock-closed" class="w-3 h-3 ml-auto text-gray-400 flex-shrink-0" title="此分頁已鎖定" />
    <div class="absolute bottom-0 left-0 right-0 h-px" :style="{ backgroundColor: getFileColor(activeFile.id) }"></div>
  </div>
</div>
```

### JavaScript 變更
```javascript
// 移除
const openTabs = ref<FileItem[]>([]);

// 簡化函數
const handleFileClick = (file: FileItem) => {
  activeFile.value = file;
  navigateToSection(file.section);
};

// 移除函數
- setActiveTab()
- closeTab() 
- initializeTabs()

// 重新命名函數
initializeTabs() → initializeActiveFile()
```

## 效果
1. **固定佈局**：Tab 列現在有固定寬度（200px），不會因為內容變化影響 main 區域
2. **簡化邏輯**：移除複雜的多 Tab 管理邏輯，程式碼更簡潔
3. **使用者體驗**：鎖頭圖示清楚表示分頁已鎖定，避免誤操作
4. **完全解決原問題**：Tab 長度不再影響 main 區域的大小

## 文件狀態
- 修改檔案：`src/layouts/default.vue`
- 新增對話紀錄：`.claude/claudeLog/claudeLog20250910_142300.md`